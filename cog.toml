#:schema https://docs.cocogitto.io/cog-schema.json
# For a reference of possible values: https://docs.cocogitto.io/config/

# A list of glob patterns describing branches on which semver bump are allowed
branch_whitelist = ["main"]

# Ignore merge commits from conventional commit checks
ignore_merge_commits = true

# A list of command to run BEFORE creating a version.
# All change generated by those commands will be committed with the generated version commit.
# `{{version}}` will be interpreted as your target version
pre_bump_hooks = [
    "cargo test",
    "cargo clippy",
    "cargo fmt --all",
    "cargo set-version {{version}}",
    "cargo run --features docgen --bin cog-doc json-schema --out website/public/cog-schema.json",
    "cargo run --features docgen --bin cog-doc reference --out website/reference/config.md",
    "cargo build --release",
]

# A list of command to run AFTER creating a version.
# `{{version}}` will be interpreted as your target version
post_bump_hooks = [
    "git push",
    "git push origin {{version}}",
    "cargo package",
    "cargo publish"
]

# A custom named bump profile, the inner post/pre bump hook will be used
# instead of the main ones when running `cog bump --hook-profile example --auto`
[bump_profiles.example]
pre_bump_hooks = [
    "echo 'bumping from {{latest}} to {{version}} using a named profile'"
]
post_bump_hooks = [
    "echo 'we are done'"
]

# Shareable git-hooks, can be installed using `cog install-hook --all`
# or alternatively `cog install-hooks {commit_hook_type}
[git_hooks.commit-msg]
script = """#!/bin/sh
set -e

echo "[Check current commit message]"
cog verify --file $1

echo "[Conventional commit check]"
cog check

echo "[Format code]"
cargo fmt -v --all --check

echo "[Lints]"
cargo clippy
"""

# An optional list of additional allowed commit type
# `cog commit {commit_type}` commit command will be generated at runtime
[commit_types]
ex = { changelog_title = "This is the markdown title for `ex` commit type" }
chore = { omit_from_changelog = true }
test = { omit_from_changelog = true }

[changelog]
path = "CHANGELOG.md"
template = "remote"
remote = "github.com"
repository = "cocogitto"
owner = "cocogitto"
provider = "github"
